# 状态: [Accepted](http://dsbpython.openjudge.cn/dspythonbook/solution/48837665/)

```
基本信息
#: 48837665
题目: P1320
提交人: 谢冰2400011514(xb谢神)
内存: 3660kB
时间: 24ms
语言: Python3
提交时间: 2025-04-07 08:31:40
```

​下面是对算法和代码的详细说明。

---

## 问题描述

给定一串用空格隔开的整数（可能存在重复数字），要求建立一棵二叉搜索树（BST），在插入时对于重复数字只保留一个（即忽略后续重复），然后对这棵树进行层次遍历（广度优先遍历），并输出遍历结果。输出时要求数字之间以空格分隔，最后不带多余的空格和换行符。

---

## 算法思路

### 1. 二叉搜索树（BST）的构建

- **定义节点结构**：每个节点包含一个整数值，以及指向左子节点和右子节点的指针。
- **插入操作**：
  - 如果当前树为空，则直接创建一个节点作为根节点。
  - 否则，从根节点开始比较：
    - 如果要插入的值小于当前节点值，则递归将该值插入当前节点的左子树。
    - 如果大于当前节点值，则递归将该值插入当前节点的右子树。
    - 如果等于当前节点值（重复），则忽略插入操作，不做处理。

为了避免重复的数字，我们使用一个集合来记录已经插入的数字。

### 2. 层次遍历（广度优先遍历）

- **使用队列**：采用队列来实现层次遍历。初始时，将根节点入队，然后进入循环：
  - 从队列中取出当前节点，并将其值加入结果列表。
  - 如果当前节点存在左子节点，则将左子节点入队。
  - 如果存在右子节点，则将右子节点入队。
- 重复直到队列为空，即所有节点都已遍历。

---

### 代码解释

1. **导入模块**  
   - `sys`：用于读取标准输入数据。  
   - `collections.deque`：提供高效的队列操作，适用于层次遍历。

2. **Node类**  
   定义了一个节点类`Node`，包含节点的值以及指向左子节点和右子节点的指针。

3. **insert函数**  
   - 功能：在给定的BST中插入一个新节点。
   - 逻辑：
     - 如果当前节点为空，则创建一个新节点。
     - 否则，比较插入值与当前节点值的大小：
       - 小于当前节点值，递归插入到左子树；
       - 大于当前节点值，递归插入到右子树；
       - 等于时忽略（防止重复）。

4. **main函数**  
   - 读取输入：通过`sys.stdin.read()`读取所有输入数据，并用`strip()`去除首尾空白。  
   - 数据处理：将输入字符串拆分为整数列表。
   - 建立BST：
     - 利用集合`seen`记录已插入的数字，防止重复插入。
     - 依次将未重复的数字通过`insert`函数插入到BST中。
   - 层次遍历：
     - 初始化队列`deque`并将根节点入队。
     - 循环过程中不断弹出队列中的节点，将其值记录到结果列表，并将其左右子节点（如果存在）加入队列。
   - 输出结果：最终将结果列表通过空格连接成字符串，并用`print`输出，确保没有额外的空格或换行符。

---

通过这种方法，我们既完成了构造二叉搜索树的任务，也实现了层次遍历并输出结果。整个程序逻辑清晰，充分利用了递归和队列的数据结构来实现高效的树操作。