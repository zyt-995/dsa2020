# 状态: [Accepted](http://xzmdsa.openjudge.cn/2025hw5/solution/48921343/)

```
基本信息
#: 48921343
题目: 6
提交人: 谢冰2400011514(xb谢神)
内存: 7652kB
时间: 237ms
语言: Python3
提交时间: 2025-04-16 08:45:46
```

为了解决这个问题，我们需要高效地处理对满二叉树节点的子树进行增量操作和查询子树重量之和的需求。由于直接遍历子树进行操作的复杂度太高，我们采用了结合树状数组和前缀和的方法来优化性能。

### 方法思路
1. **预处理节点信息**：通过深度优先搜索（DFS）预处理每个节点的前序遍历编号（L）、子树结束编号（R）和子树大小（size）。
2. **树状数组维护**：使用树状数组来维护每个节点的增量操作影响，从而快速查询子树区间和。
3. **前缀和计算**：通过遍历祖先节点链计算前缀和，结合树状数组的区间查询，快速得到子树重量之和。

### 代码解释
1. **预处理节点信息**：使用DFS遍历树，计算每个节点的前序遍历编号（L）、子树结束编号（R）和子树大小（size）。
2. **树状数组维护**：树状数组用于高效处理区间更新和查询。每次增量操作时，更新对应节点的影响值。
3. **前缀和计算**：查询时，遍历当前节点的所有祖先节点，累加前缀和。树状数组用于快速查询子树区间的和，减去当前节点自身的贡献以避免重复计算。

这种方法确保了每次操作和查询的时间复杂度为O(log N)，能够高效处理大规模输入。