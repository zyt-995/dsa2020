# P1260:火星大工程

总时间限制：1000ms  内存限制：65536kB



# 描述

中国要在火星上搞个大工程，即建造n个科考站。

- 建科考站需要很专业的设备，不同的科考站需要不同的设备来完成。
- 有的科考站必须等另外一些科考站建好后才能建。
- 每个设备参与建完一个科考站后，都需要一定时间来保养维修，才能参与到下一个科考站的建设。

所以，会发生科考站A建好后，必须至少等一定时间才能建科考站B的情况。因为B必须在A之后建，且建B必需的某个设备，参与了建A的工作，它需要一定时间进行维修保养。

一个维修保养任务用三个数a b c表示，意即科考站b必须等a建完才能建。而且，科考站a建好后，建a的某个设备必须经过时长c的维修保养后，才可以开始参与建科考站b。

假设设备都很牛，只要设备齐全可用，建站飞快就能完成，建站时间忽略不计。一开始所有设备都齐全可用。

给定一些维修保养任务的描述，求所有科考站都建成，最快需要多长时间。

有的维修保养任务，能开始的时候也可以先不开始，往后推迟一点再开始也不会影响到整个工期。问在不影响最快工期的情况下，哪些维修保养任务的开始时间必须是确定的。按字典序输出这些维修保养任务，输出的时候不必输出任务所需的时间。

# 输入

第一行两个整数n,m，表示有n个科考站，m个维修保养任务。科考站编号为1, 2, ..., n。

接下来m行，每行三个整数a b c，表示一个维修保养任务。

1 < n, m <= 3000

# 输出
先输出所有科考站都建成所需的最短时间。

然后按字典序输出开始时间必须确定的维修保养任务。
# 样例输入
```
9 11
1 2 6
1 3 4
1 4 5
2 5 1
3 5 1
4 6 2
5 7 9
5 8 7
6 8 4
7 9 2
8 9 4
```

# 样例输出
```
18
1 2
2 5
5 7
5 8
6 8
8 9
```

# 来源

郭炜