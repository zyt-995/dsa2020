# 状态: [Accepted](http://dsbpython.openjudge.cn/dspythonbook/P1260/)

```
基本信息
#: 48820481
题目: P1260
提交人: 谢冰2400011514(xb谢神)
内存: 4340kB
时间: 31ms
语言: Python3
提交时间: 2025-04-05 09:16:10
```

为了解决这个问题，我们需要找到所有科考站建设完成的最短时间，并确定哪些维修保养任务的开始时间必须是确定的。这个问题可以通过关键路径方法来解决，关键路径上的任务决定了整个项目的最短完成时间。

### 方法思路
1. **输入处理与图构建**：读取输入数据，构建图的邻接表和逆邻接表，并统计每个节点的入度。
2. **拓扑排序**：使用Kahn算法进行拓扑排序，确定节点的处理顺序。
3. **计算最早时间**：根据拓扑顺序，计算每个节点的最早开始时间。
4. **计算最晚时间**：根据逆拓扑顺序，计算每个节点的最晚开始时间。
5. **确定关键路径**：遍历所有边，判断每条边的总时差是否为0，确定关键边。
6. **输出结果**：输出最短完成时间，并按字典序输出关键边。

### 代码解释
1. **输入处理与图构建**：读取输入的科考站和维修任务数量，构建邻接表和逆邻接表，统计每个节点的入度。
2. **拓扑排序**：使用Kahn算法进行拓扑排序，确定节点的处理顺序，确保在处理每个节点时其前驱节点已被处理。
3. **计算最早时间**：根据拓扑顺序，计算每个节点的最早开始时间，确保每个节点的开始时间是其所有前驱节点完成后的最大值。
4. **计算最晚时间**：根据逆拓扑顺序，计算每个节点的最晚开始时间，确保每个节点的开始时间不影响其后继节点的最晚开始时间。
5. **确定关键路径**：遍历所有边，判断每条边的总时差是否为0，确定关键边，并按字典序排序输出。

通过这种方法，可以高效地找到所有科考站建设的最短时间，并确定必须按时开始的关键任务。