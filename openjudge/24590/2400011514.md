# 状态: [Accepted](http://xzmdsa.openjudge.cn/2024hw1tmp/solution/48296796/)

```
基本信息
#: 49184141
题目: P0440
提交人: 谢冰2400011514(xb谢神)
内存: 3972kB
时间: 29ms
语言: Python3
提交时间: 2025-05-17 10:50:53
```

要解决这个问题，我们需要对一个包含加减乘除和括号的四则运算表达式进行求值。由于运算符的优先级和括号的存在，直接按顺序计算是不行的。我们可以使用双栈法（一个栈存放操作数，另一个栈存放运算符）来处理运算符的优先级和括号的嵌套。

### 方法思路
1. **初始化两个栈**：一个用于存储操作数（`values`），另一个用于存储运算符（`ops`）。
2. **处理表达式中的每个字符**：
   - **数字**：读取完整的数字（包括小数点），并将其压入操作数栈。
   - **左括号 '('**：直接压入运算符栈。
   - **右括号 ')'**：弹出运算符和操作数进行计算，直到遇到左括号为止。
   - **运算符**：在压入当前运算符之前，先处理栈顶优先级不低于当前运算符的所有运算，以确保正确的运算顺序。
3. **处理剩余运算**：表达式处理完毕后，将运算符栈中剩余的运算符依次弹出并进行计算。
4. **输出结果**：操作数栈中剩下的最后一个数就是表达式的结果，保留两位小数。

### 代码解释
1. **函数`evaluate_expression`**：处理给定的四则运算表达式并返回计算结果。
   - **栈初始化**：`ops`栈存储运算符，`values`栈存储操作数。
   - **字符处理循环**：逐个字符处理表达式：
     - **空格**：跳过空格。
     - **左括号**：直接压入`ops`栈。
     - **右括号**：弹出`ops`栈中的运算符并进行计算，直到遇到左括号。
     - **运算符**：处理栈顶优先级不低于当前运算符的运算，再压入当前运算符。
     - **数字**：读取完整的数字字符串并转换为浮点数，压入`values`栈。
   - **剩余运算处理**：处理完所有字符后，继续处理`ops`栈中剩余的运算符。
   - **返回结果**：`values`栈中剩下的唯一数字即为结果。
2. **输入输出处理**：读取输入的表达式数量`n`，逐个处理每个表达式并输出结果，保留两位小数。

这种方法有效地处理了运算符优先级和括号的嵌套问题，确保了表达式计算的正确性。

